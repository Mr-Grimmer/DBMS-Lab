-- Assignment 1

-- Q1) Create the following tables
CREATE TABLE EMPLOYEE (
   EMP_CODE CHAR(16) PRIMARY KEY,
   EMP_NAME CHAR(20),
   DEPT_CODE CHAR(16),
   DESIG_CODE CHAR(16),
   SEX CHAR(1),
   ADDRESS CHAR(25),
   CITY CHAR(20),
   STATE CHAR(20),
   PIN CHAR(6),
   BASIC DECIMAL(9,2),
   JN_DT DATE
);

CREATE TABLE DESIGNATION (
   DESIG_CODE CHAR(16) PRIMARY KEY,
   DESIG_DESC CHAR(20)
);

CREATE TABLE DEPARTMENT (
   DEPT_CODE CHAR(16) PRIMARY KEY,
   DEPT_NAME CHAR(20)
);

-- Q2) Display the structure of each table (for MySQL/PostgreSQL)
 desc EMPLOYEE;
 desc DESIGNATION;
 desc DEPARTMENT;

-- Q3) Insert few rows into each table

-- DESIGNATION data
INSERT INTO DESIGNATION VALUES ('D001','Manager');
INSERT INTO DESIGNATION VALUES ('D002','Executive');
INSERT INTO DESIGNATION VALUES ('D003','Officer');
INSERT INTO DESIGNATION VALUES ('D004','Clerk');
INSERT INTO DESIGNATION VALUES ('D005','Helper');

-- DEPARTMENT data
INSERT INTO DEPARTMENT VALUES ('DP01','Personnel');
INSERT INTO DEPARTMENT VALUES ('DP02','Production');
INSERT INTO DEPARTMENT VALUES ('DP03','Purchase');
INSERT INTO DEPARTMENT VALUES ('DP04','Finance');
INSERT INTO DEPARTMENT VALUES ('DP05','Research');

-- EMPLOYEE data
INSERT INTO EMPLOYEE VALUES ('E001','TAPAN','DP01', 'D001', 'M','BALARAMPUR','PURULIA','WEST BENGAL','723103',80000, TO_DATE('21:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E002','ROHIT','DP02', 'D002', 'M','ABC','PURULIA','WEST BENGAL','723102',70000, TO_DATE('21:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E003','SUDIP',NULL, 'D002', 'M','ABC','PURULIA','WEST BENGAL','723102', NULL, TO_DATE('21:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E004','AMIT','DP03', 'D003', 'M','ABC','PURULIA','WEST BENGAL','723102',0, TO_DATE('21:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E005','ABC','DP03', 'D004', 'M','ABC_D','PURULIA','WEST BENGAL','723102',0, TO_DATE('01:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E006','DEF','DP02', 'D005', 'M','ABC','PURULIA','WEST BENGAL','723102',0, TO_DATE('02:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E007','GHI','DP01', 'D005', 'M','ABC','PURULIA','WEST BENGAL','723102',0, TO_DATE('22:01:2024','DD:MM:YYYY'));
INSERT INTO EMPLOYEE VALUES ('E008','ANITA','DP01', 'D005', 'F','ABC','PURULIA','WEST BENGAL','723102',60000, TO_DATE('23:01:2024','DD:MM:YYYY'));

-- Q4) Insert few rows without DEPT_CODE and BASIC (already done above for E003)

-- Q5) Find rows with unassigned DEPT_CODE
SELECT * FROM EMPLOYEE WHERE DEPT_CODE IS NULL;

-- Q6) Find rows with BASIC unassigned
SELECT * FROM EMPLOYEE WHERE BASIC IS NULL;

-- Q7) Find rows with BASIC = 0
SELECT * FROM EMPLOYEE WHERE BASIC = 0;

-- Q8) Find the average BASIC of employees
SELECT AVG(BASIC) AS average_basic FROM EMPLOYEE;

-- Q9) Replace NULL BASIC with 0
UPDATE EMPLOYEE SET BASIC = 0 WHERE BASIC IS NULL;

-- Q10) Find the new average BASIC
SELECT AVG(BASIC) AS average_basic FROM EMPLOYEE;

-- Q11) Delete rows with unassigned DEPT_CODE
DELETE FROM EMPLOYEE WHERE DEPT_CODE IS NULL;

-- Q12) Show EMP_NAME and Net Pay (Net Pay = Basic + 50% HRA + 40% DA)
SELECT EMP_NAME,
       0.5 * BASIC AS HRA,
       0.4 * BASIC AS DA,
       BASIC + 0.5 * BASIC + 0.4 * BASIC AS NET_PAY
FROM EMPLOYEE;

-- Q13) Show EMP_NAME and BASIC in ascending order of DEPT_CODE with uppercase names
SELECT UPPER(EMP_NAME) AS EMPLOYEE_NAME, BASIC
FROM EMPLOYEE
ORDER BY DEPT_CODE ASC;

-- Q14) Find employees who joined after 1st January 2010
SELECT * 
FROM EMPLOYEE 
WHERE JN_DT > TO_DATE('2010-01-01', 'YYYY-MM-DD');

-- Q15) Number of employees who joined in January
SELECT COUNT(*) 
FROM EMPLOYEE 
WHERE TO_CHAR(JN_DT, 'MM') = '01';

-- Q16) Find maximum and minimum BASIC
SELECT MAX(BASIC) AS MAXIMUM, MIN(BASIC) AS MINIMUM FROM EMPLOYEE;

-- Q17) Count of female employees
SELECT COUNT(*) FROM EMPLOYEE WHERE SEX = 'F';

-- Q18) Convert CITY to uppercase
UPDATE EMPLOYEE SET CITY = UPPER(CITY);

-- Q19) Find number of distinct cities employees are from
SELECT COUNT(DISTINCT CITY) AS DISTINCT_CITY FROM EMPLOYEE;

-- Q20) Show employees ordered by DEPT_CODE ASC, and BASIC DESC within department
SELECT * 
FROM EMPLOYEE 
ORDER BY DEPT_CODE ASC, BASIC DESC;
